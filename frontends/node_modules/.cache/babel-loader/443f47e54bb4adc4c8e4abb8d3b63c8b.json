{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Zakia hussaini/Desktop/Stories-Blog/frontends/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _toConsumableArray from\"C:/Users/Zakia hussaini/Desktop/Stories-Blog/frontends/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"C:/Users/Zakia hussaini/Desktop/Stories-Blog/frontends/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/Zakia hussaini/Desktop/Stories-Blog/frontends/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{axiosReq}from\"../api/axiosDefaults\";import jwtDecode from\"jwt-decode\";export var fetchMoreData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(resource,setResource){var _yield$axiosReq$get,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axiosReq.get(resource.next);case 3:_yield$axiosReq$get=_context.sent;data=_yield$axiosReq$get.data;setResource(function(prevResource){return _objectSpread(_objectSpread({},prevResource),{},{next:data.next,results:data.results.reduce(function(acc,cur){return acc.some(function(accResult){return accResult.id===cur.id;})?acc:[].concat(_toConsumableArray(acc),[cur]);},prevResource.results)});});_context.next=10;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);case 10:case\"end\":return _context.stop();}},_callee,null,[[0,8]]);}));return function fetchMoreData(_x,_x2){return _ref.apply(this,arguments);};}();export var followHelper=function followHelper(profile,clickedProfile,following_id){return profile.id===clickedProfile.id?_objectSpread(_objectSpread({},profile),{},{followers_count:profile.followers_count+1,following_id:following_id}):profile.is_owner?_objectSpread(_objectSpread({},profile),{},{following_count:profile.following_count+1}):profile;};export var unfollowHelper=function unfollowHelper(profile,clickedProfile){return profile.id===clickedProfile.id?_objectSpread(_objectSpread({},profile),{},{followers_count:profile.followers_count-1,following_id:null}):profile.is_owner?_objectSpread(_objectSpread({},profile),{},{following_count:profile.following_count-1}):profile;};export var setTokenTimestamp=function setTokenTimestamp(data){var refreshTokenTimestamp=jwtDecode(data===null||data===void 0?void 0:data.refresh_token).exp;localStorage.setItem(\"refreshTokenTimestamp\",refreshTokenTimestamp);};export var shouldRefreshToken=function shouldRefreshToken(){return!!localStorage.getItem(\"refreshTokenTimestamp\");};export var removeTokenTimestamp=function removeTokenTimestamp(){localStorage.removeItem(\"refreshTokenTimestamp\");};","map":{"version":3,"names":["axiosReq","jwtDecode","fetchMoreData","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","resource","setResource","_yield$axiosReq$get","data","wrap","_callee$","_context","prev","next","get","sent","prevResource","_objectSpread","results","reduce","acc","cur","some","accResult","id","concat","_toConsumableArray","t0","stop","_x","_x2","apply","arguments","followHelper","profile","clickedProfile","following_id","followers_count","is_owner","following_count","unfollowHelper","setTokenTimestamp","refreshTokenTimestamp","refresh_token","exp","localStorage","setItem","shouldRefreshToken","getItem","removeTokenTimestamp","removeItem"],"sources":["C:/Users/Zakia hussaini/Desktop/Stories-Blog/frontends/src/utils/utils.js"],"sourcesContent":["import { axiosReq } from \"../api/axiosDefaults\";\r\nimport jwtDecode from \"jwt-decode\";\r\n\r\n\r\nexport const fetchMoreData = async (resource, setResource) => {\r\n  try {\r\n    const { data } = await axiosReq.get(resource.next);\r\n    setResource((prevResource) => ({\r\n      ...prevResource,\r\n      next: data.next,\r\n      results: data.results.reduce((acc, cur) => {\r\n        return acc.some((accResult) => accResult.id === cur.id)\r\n          ? acc\r\n          : [...acc, cur];\r\n      }, prevResource.results),\r\n    }));\r\n  } catch (err) {}\r\n};\r\n\r\n\r\nexport const followHelper = (profile, clickedProfile, following_id) => {\r\n    return profile.id === clickedProfile.id\r\n      ? \r\n        {\r\n          ...profile,\r\n          followers_count: profile.followers_count + 1,\r\n          following_id,\r\n        }\r\n      : profile.is_owner\r\n      ? \r\n        { ...profile, following_count: profile.following_count + 1 }\r\n      : \r\n        profile;\r\n  };\r\n\r\n  export const unfollowHelper = (profile, clickedProfile) => {\r\n    return profile.id === clickedProfile.id\r\n      ? \r\n        {\r\n          ...profile,\r\n          followers_count: profile.followers_count - 1,\r\n          following_id: null,\r\n        }\r\n      : profile.is_owner\r\n      ? \r\n        { ...profile, following_count: profile.following_count - 1 }\r\n      : \r\n        profile;\r\n  };\r\n\r\n\r\n\r\n  export const setTokenTimestamp = (data) => {\r\n    const refreshTokenTimestamp = jwtDecode(data?.refresh_token).exp;\r\n    localStorage.setItem(\"refreshTokenTimestamp\", refreshTokenTimestamp);\r\n  };\r\n  \r\n  export const shouldRefreshToken = () => {\r\n    return !!localStorage.getItem(\"refreshTokenTimestamp\");\r\n  };\r\n  \r\n  export const removeTokenTimestamp = () => {\r\n    localStorage.removeItem(\"refreshTokenTimestamp\");\r\n  };"],"mappings":"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"},"metadata":{},"sourceType":"module"}