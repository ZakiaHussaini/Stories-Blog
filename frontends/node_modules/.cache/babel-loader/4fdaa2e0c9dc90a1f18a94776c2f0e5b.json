{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Zakia hussaini/Desktop/Stories-Blog/frontends/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"C:/Users/Zakia hussaini/Desktop/Stories-Blog/frontends/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/Zakia hussaini/Desktop/Stories-Blog/frontends/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Zakia hussaini/Desktop/Stories-Blog/frontends/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{createContext,useContext,useEffect,useState}from\"react\";import{axiosReq,axiosRes}from\"../api/axiosDefaults\";import{useCurrentUser}from\"../contexts/CurrentUserContext\";import{followHelper,unfollowHelper}from\"../utils/utils\";import{jsx as _jsx}from\"react/jsx-runtime\";var ProfileDataContext=/*#__PURE__*/createContext();var SetProfileDataContext=/*#__PURE__*/createContext();export var useProfileData=function useProfileData(){return useContext(ProfileDataContext);};export var useSetProfileData=function useSetProfileData(){return useContext(SetProfileDataContext);};export var ProfileDataProvider=function ProfileDataProvider(_ref){var children=_ref.children;var _useState=useState({pageProfile:{results:[]},popularProfiles:{results:[]}}),_useState2=_slicedToArray(_useState,2),profileData=_useState2[0],setProfileData=_useState2[1];var currentUser=useCurrentUser();var handleFollow=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(clickedProfile){var _yield$axiosRes$post,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axiosRes.post(\"/followers/\",{followed:clickedProfile.id});case 3:_yield$axiosRes$post=_context.sent;data=_yield$axiosRes$post.data;setProfileData(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{pageProfile:{results:prevState.pageProfile.results.map(function(profile){return followHelper(profile,clickedProfile,data.id);})},popularProfiles:_objectSpread(_objectSpread({},prevState.popularProfiles),{},{results:prevState.popularProfiles.results.map(function(profile){return followHelper(profile,clickedProfile,data.id);})})});});_context.next=10;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);case 10:case\"end\":return _context.stop();}},_callee,null,[[0,8]]);}));return function handleFollow(_x){return _ref2.apply(this,arguments);};}();var handleUnfollow=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(clickedProfile){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axiosRes.delete(\"/followers/\".concat(clickedProfile.following_id,\"/\"));case 3:setProfileData(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{pageProfile:{results:prevState.pageProfile.results.map(function(profile){return unfollowHelper(profile,clickedProfile);})},popularProfiles:_objectSpread(_objectSpread({},prevState.popularProfiles),{},{results:prevState.popularProfiles.results.map(function(profile){return unfollowHelper(profile,clickedProfile);})})});});_context2.next=8;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);case 8:case\"end\":return _context2.stop();}},_callee2,null,[[0,6]]);}));return function handleUnfollow(_x2){return _ref3.apply(this,arguments);};}();useEffect(function(){var handleMount=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var _yield$axiosReq$get,data;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axiosReq.get(\"/profiles/?ordering=-followers_count\");case 3:_yield$axiosReq$get=_context3.sent;data=_yield$axiosReq$get.data;setProfileData(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{popularProfiles:data});});_context3.next=10;break;case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](0);case 10:case\"end\":return _context3.stop();}},_callee3,null,[[0,8]]);}));return function handleMount(){return _ref4.apply(this,arguments);};}();handleMount();},[currentUser]);return/*#__PURE__*/_jsx(ProfileDataContext.Provider,{value:profileData,children:/*#__PURE__*/_jsx(SetProfileDataContext.Provider,{value:{setProfileData:setProfileData,handleFollow:handleFollow,handleUnfollow:handleUnfollow},children:children})});};","map":{"version":3,"names":["createContext","useContext","useEffect","useState","axiosReq","axiosRes","useCurrentUser","followHelper","unfollowHelper","jsx","_jsx","ProfileDataContext","SetProfileDataContext","useProfileData","useSetProfileData","ProfileDataProvider","_ref","children","_useState","pageProfile","results","popularProfiles","_useState2","_slicedToArray","profileData","setProfileData","currentUser","handleFollow","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","clickedProfile","_yield$axiosRes$post","data","wrap","_callee$","_context","prev","next","post","followed","id","sent","prevState","_objectSpread","map","profile","t0","stop","_x","apply","arguments","handleUnfollow","_ref3","_callee2","_callee2$","_context2","delete","concat","following_id","_x2","handleMount","_ref4","_callee3","_yield$axiosReq$get","_callee3$","_context3","get","Provider","value"],"sources":["C:/Users/Zakia hussaini/Desktop/Stories-Blog/frontends/src/contexts/ProfileDataContext.js"],"sourcesContent":["import { createContext, useContext, useEffect, useState } from \"react\";\r\nimport { axiosReq, axiosRes } from \"../api/axiosDefaults\";\r\nimport { useCurrentUser } from \"../contexts/CurrentUserContext\";\r\nimport { followHelper, unfollowHelper } from \"../utils/utils\";\r\n\r\nconst ProfileDataContext = createContext();\r\nconst SetProfileDataContext = createContext();\r\n\r\nexport const useProfileData = () => useContext(ProfileDataContext);\r\nexport const useSetProfileData = () => useContext(SetProfileDataContext);\r\n\r\nexport const ProfileDataProvider = ({ children }) => {\r\n  const [profileData, setProfileData] = useState({\r\n    \r\n    pageProfile: { results: [] },\r\n    popularProfiles: { results: [] },\r\n  });\r\n\r\n  const currentUser = useCurrentUser();\r\n\r\n  const handleFollow = async (clickedProfile) => {\r\n    try {\r\n      const { data } = await axiosRes.post(\"/followers/\", {\r\n        followed: clickedProfile.id,\r\n      });\r\n\r\n      setProfileData((prevState) => ({\r\n        ...prevState,\r\n        pageProfile: {\r\n          results: prevState.pageProfile.results.map((profile) =>\r\n            followHelper(profile, clickedProfile, data.id)\r\n          ),\r\n        },\r\n        popularProfiles: {\r\n          ...prevState.popularProfiles,\r\n          results: prevState.popularProfiles.results.map((profile) =>\r\n            followHelper(profile, clickedProfile, data.id)\r\n          ),\r\n        },\r\n      }));\r\n    } catch (err) {\r\n    }\r\n  };\r\n\r\n  const handleUnfollow = async (clickedProfile) => {\r\n    try {\r\n      await axiosRes.delete(`/followers/${clickedProfile.following_id}/`);\r\n\r\n      setProfileData((prevState) => ({\r\n        ...prevState,\r\n        pageProfile: {\r\n          results: prevState.pageProfile.results.map((profile) =>\r\n            unfollowHelper(profile, clickedProfile)\r\n          ),\r\n        },\r\n        popularProfiles: {\r\n          ...prevState.popularProfiles,\r\n          results: prevState.popularProfiles.results.map((profile) =>\r\n            unfollowHelper(profile, clickedProfile)\r\n          ),\r\n        },\r\n      }));\r\n    } catch (err) {\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const handleMount = async () => {\r\n      try {\r\n        const { data } = await axiosReq.get(\r\n          \"/profiles/?ordering=-followers_count\"\r\n        );\r\n        setProfileData((prevState) => ({\r\n          ...prevState,\r\n          popularProfiles: data,\r\n        }));\r\n      } catch (err) {\r\n      }\r\n    };\r\n\r\n    handleMount();\r\n  }, [currentUser]);\r\n\r\n  return (\r\n    <ProfileDataContext.Provider value={profileData}>\r\n      <SetProfileDataContext.Provider\r\n        value={{ setProfileData, handleFollow, handleUnfollow }}\r\n      >\r\n        {children}\r\n      </SetProfileDataContext.Provider>\r\n    </ProfileDataContext.Provider>\r\n  );\r\n};"],"mappings":"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"},"metadata":{},"sourceType":"module"}