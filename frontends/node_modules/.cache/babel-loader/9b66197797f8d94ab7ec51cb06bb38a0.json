{"ast":null,"code":"import _objectSpread from\"C:/Users/Zakia hussaini/Desktop/Stories-Blog/frontends/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/Zakia hussaini/Desktop/Stories-Blog/frontends/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Zakia hussaini/Desktop/Stories-Blog/frontends/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Zakia hussaini/Desktop/Stories-Blog/frontends/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import Col from\"react-bootstrap/Col\";import Row from\"react-bootstrap/Row\";import Container from\"react-bootstrap/Container\";import appStyles from\"../../App.module.css\";import{useParams}from\"react-router\";import{axiosReq}from\"../../api/axiosDefaults\";import Post from\"./Post\";import CommentCreateForm from\"../comments/CommentCreateForm\";import{useCurrentUser}from\"../../contexts/CurrentUserContext\";import Comment from\"../comments/Comment\";import InfiniteScroll from\"react-infinite-scroll-component\";import Asset from\"../../components/Asset\";import{fetchMoreData}from\"../../utils/utils\";import PopularProfiles from\"../profiles/PopularProfiles\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function PostPage(){var _useParams=useParams(),id=_useParams.id;var _useState=useState({results:[]}),_useState2=_slicedToArray(_useState,2),story=_useState2[0],setStory=_useState2[1];var currentUser=useCurrentUser();var profile_image=currentUser===null||currentUser===void 0?void 0:currentUser.profile_image;var _useState3=useState({results:[]}),_useState4=_slicedToArray(_useState3,2),comments=_useState4[0],setComments=_useState4[1];useEffect(function(){var handleMount=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$Promise$all,_yield$Promise$all2,_story,_comments;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return Promise.all([axiosReq.get(\"/stories/\".concat(id)),axiosReq.get(\"/comments/?story=\".concat(id))]);case 3:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);_story=_yield$Promise$all2[0].data;_comments=_yield$Promise$all2[1].data;setStory({results:[_story]});setComments(_comments);_context.next=13;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);case 13:case\"end\":return _context.stop();}},_callee,null,[[0,11]]);}));return function handleMount(){return _ref.apply(this,arguments);};}();handleMount();},[id]);return/*#__PURE__*/_jsxs(Row,{className:\"h-100\",children:[/*#__PURE__*/_jsxs(Col,{className:\"py-2 p-0 p-lg-2\",lg:8,children:[/*#__PURE__*/_jsx(PopularProfiles,{mobile:true}),/*#__PURE__*/_jsx(Post,_objectSpread(_objectSpread({},story.results[0]),{},{setStory:setStory,postPage:true})),/*#__PURE__*/_jsxs(Container,{className:appStyles.Content,children:[currentUser?/*#__PURE__*/_jsx(CommentCreateForm,{profile_id:currentUser.profile_id,profileImage:profile_image,story:id,setStory:setStory,setComments:setComments}):comments.results.length?\"Comments\":null,comments.results.length?/*#__PURE__*/_jsx(InfiniteScroll,{children:comments.results.map(function(comment){return/*#__PURE__*/_jsx(Comment,_objectSpread(_objectSpread({},comment),{},{setStory:setStory,setComments:setComments}),comment.id);}),dataLength:comments.results.length,loader:/*#__PURE__*/_jsx(Asset,{spinner:true}),hasMore:!!comments.next,next:function next(){return fetchMoreData(comments,setComments);}}):currentUser?/*#__PURE__*/_jsx(\"span\",{children:\"No comments yet, be the first to comment!\"}):/*#__PURE__*/_jsx(\"span\",{children:\"No comments... yet\"})]})]}),/*#__PURE__*/_jsx(Col,{lg:4,className:\"d-none d-lg-block p-0 p-lg-2\",children:/*#__PURE__*/_jsx(PopularProfiles,{desktop:true})})]});}export default PostPage;","map":{"version":3,"names":["React","useEffect","useState","Col","Row","Container","appStyles","useParams","axiosReq","Post","CommentCreateForm","useCurrentUser","Comment","InfiniteScroll","Asset","fetchMoreData","PopularProfiles","jsx","_jsx","jsxs","_jsxs","PostPage","_useParams","id","_useState","results","_useState2","_slicedToArray","story","setStory","currentUser","profile_image","_useState3","_useState4","comments","setComments","handleMount","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$Promise$all","_yield$Promise$all2","_story","_comments","wrap","_callee$","_context","prev","next","Promise","all","get","concat","sent","data","t0","stop","apply","arguments","className","children","lg","mobile","_objectSpread","postPage","Content","profile_id","profileImage","length","map","comment","dataLength","loader","spinner","hasMore","desktop"],"sources":["C:/Users/Zakia hussaini/Desktop/Stories-Blog/frontends/src/pages/posts/PostPage.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\n\r\nimport Col from \"react-bootstrap/Col\";\r\nimport Row from \"react-bootstrap/Row\";\r\nimport Container from \"react-bootstrap/Container\";\r\n\r\nimport appStyles from \"../../App.module.css\";\r\nimport { useParams } from \"react-router\";\r\nimport { axiosReq } from \"../../api/axiosDefaults\";\r\nimport Post from \"./Post\";\r\nimport CommentCreateForm from \"../comments/CommentCreateForm\";\r\nimport { useCurrentUser } from \"../../contexts/CurrentUserContext\";\r\nimport Comment from \"../comments/Comment\";\r\nimport InfiniteScroll from \"react-infinite-scroll-component\";\r\nimport Asset from \"../../components/Asset\";\r\nimport { fetchMoreData } from \"../../utils/utils\";\r\nimport PopularProfiles from \"../profiles/PopularProfiles\";\r\n\r\n\r\nfunction PostPage() {\r\n  const { id } = useParams();\r\n  const [story, setStory] = useState({ results: [] });\r\n\r\n  const currentUser = useCurrentUser();\r\n  const profile_image = currentUser?.profile_image;\r\n  const [comments, setComments] = useState({ results: [] });\r\n\r\n  useEffect(() => {\r\n    const handleMount = async () => {\r\n      try {\r\n        const [{ data: story }, { data: comments }] = await Promise.all([\r\n          axiosReq.get(`/stories/${id}`),\r\n          axiosReq.get(`/comments/?story=${id}`),\r\n        ]);\r\n        setStory({ results: [story] });\r\n        setComments(comments);\r\n      } catch (err) {\r\n      }\r\n    };\r\n\r\n    handleMount();\r\n  }, [id]);\r\n\r\n\r\n\r\n  return (\r\n    <Row className=\"h-100\">\r\n    <Col className=\"py-2 p-0 p-lg-2\" lg={8}>\r\n    <PopularProfiles mobile />\r\n      <Post {...story.results[0]} setStory={setStory} postPage />\r\n      <Container className={appStyles.Content}>\r\n        {currentUser ? (\r\n          <CommentCreateForm\r\n            profile_id={currentUser.profile_id}\r\n            profileImage={profile_image}\r\n            story={id}\r\n            setStory={setStory}\r\n            setComments={setComments}\r\n          />\r\n        ) : comments.results.length ? (\r\n          \"Comments\"\r\n        ) : null}\r\n        {comments.results.length ? (\r\n          <InfiniteScroll\r\n            children={comments.results.map((comment) => (\r\n              <Comment\r\n                key={comment.id}\r\n                {...comment}\r\n                setStory={setStory}\r\n                setComments={setComments}\r\n              />\r\n            ))}\r\n            dataLength={comments.results.length}\r\n            loader={<Asset spinner />}\r\n            hasMore={!!comments.next}\r\n            next={() => fetchMoreData(comments, setComments)}\r\n          />\r\n        ) : currentUser ? (\r\n          <span>No comments yet, be the first to comment!</span>\r\n        ) : (\r\n          <span>No comments... yet</span>\r\n        )}\r\n      </Container>\r\n    </Col>\r\n    <Col lg={4} className=\"d-none d-lg-block p-0 p-lg-2\">\r\n    <PopularProfiles desktop />\r\n    </Col>\r\n  </Row>\r\n  );\r\n}\r\n\r\nexport default PostPage;"],"mappings":"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"},"metadata":{},"sourceType":"module"}