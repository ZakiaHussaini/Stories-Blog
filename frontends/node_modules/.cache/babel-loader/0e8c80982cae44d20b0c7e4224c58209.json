{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/zakia.hussaini/Documents/Stories-Blog-1/frontends/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"C:/Users/zakia.hussaini/Documents/Stories-Blog-1/frontends/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/zakia.hussaini/Documents/Stories-Blog-1/frontends/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/zakia.hussaini/Documents/Stories-Blog-1/frontends/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from\"react\";import{Media}from\"react-bootstrap\";import{Link}from\"react-router-dom\";import Avatar from\"../../components/Avatar\";import{MoreDropdown}from\"../../components/MoreDropdown\";import CommentEditForm from\"./CommentEditForm\";import styles from\"../../styles/Comment.module.css\";import{useCurrentUser}from\"../../contexts/CurrentUserContext\";import{axiosRes}from\"../../api/axiosDefaults\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Comment=function Comment(props){var profile_id=props.profile_id,profile_image=props.profile_image,owner=props.owner,id=props.id,updated_at=props.updated_at,content=props.content,setComments=props.setComments,setPost=props.setPost;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showEditForm=_useState2[0],setShowEditForm=_useState2[1];var currentUser=useCurrentUser();var is_owner=(currentUser===null||currentUser===void 0?void 0:currentUser.username)===owner;var handleDelete=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axiosRes.delete(\"/comments/\".concat(id,\"/\"));case 3:setPost(function(prevPost){return{results:[_objectSpread(_objectSpread({},prevPost.results[0]),{},{comments_count:prevPost.results[0].comments_count-1})]};});setComments(function(prevComments){return _objectSpread(_objectSpread({},prevComments),{},{results:prevComments.results.filter(function(comment){return comment.id!==id;})});});_context.next=9;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);case 9:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return function handleDelete(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(Media,{className:styles.mainDiv,children:[/*#__PURE__*/_jsx(\"div\",{children:is_owner&&!showEditForm&&/*#__PURE__*/_jsx(MoreDropdown,{handleEdit:function handleEdit(){return setShowEditForm(true);},handleDelete:handleDelete})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Link,{to:\"/profiles/\".concat(profile_id),children:/*#__PURE__*/_jsx(Avatar,{src:profile_image})})}),/*#__PURE__*/_jsxs(Media.Body,{className:\"align-self-center ml-2\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:styles.Owner,children:owner}),/*#__PURE__*/_jsx(\"span\",{className:styles.Date,children:updated_at})]}),showEditForm?/*#__PURE__*/_jsx(CommentEditForm,{id:id,profile_id:profile_id,content:content,profileImage:profile_image,setComments:setComments,setShowEditForm:setShowEditForm}):/*#__PURE__*/_jsxs(\"div\",{children:[\" \",/*#__PURE__*/_jsx(\"p\",{children:content})]})]})]})]});};export default Comment;","map":{"version":3,"names":["React","useState","Media","Link","Avatar","MoreDropdown","CommentEditForm","styles","useCurrentUser","axiosRes","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Comment","props","profile_id","profile_image","owner","id","updated_at","content","setComments","setPost","_useState","_useState2","_slicedToArray","showEditForm","setShowEditForm","currentUser","is_owner","username","handleDelete","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","delete","concat","prevPost","results","_objectSpread","comments_count","prevComments","filter","comment","t0","stop","apply","arguments","children","className","mainDiv","handleEdit","to","src","Body","Owner","Date","profileImage"],"sources":["C:/Users/zakia.hussaini/Documents/Stories-Blog-1/frontends/src/pages/comments/Comment.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { Media } from \"react-bootstrap\";\r\nimport { Link } from \"react-router-dom\";\r\nimport Avatar from \"../../components/Avatar\";\r\nimport { MoreDropdown } from \"../../components/MoreDropdown\";\r\nimport CommentEditForm from \"./CommentEditForm\";\r\n\r\nimport styles from \"../../styles/Comment.module.css\";\r\nimport { useCurrentUser } from \"../../contexts/CurrentUserContext\";\r\nimport { axiosRes } from \"../../api/axiosDefaults\";\r\n\r\n\r\nconst Comment = (props) => {\r\n  const { profile_id, profile_image, owner, id, updated_at,\r\n     content, setComments, setPost } = props;\r\n\r\n  const [showEditForm, setShowEditForm] = useState(false);\r\n  const currentUser = useCurrentUser();\r\n  const is_owner = currentUser?.username === owner;\r\n\r\n\r\n  const handleDelete = async () => {\r\n    try {\r\n      await axiosRes.delete(`/comments/${id}/`);\r\n      setPost((prevPost) => ({\r\n        results: [\r\n          {\r\n            ...prevPost.results[0],\r\n            comments_count: prevPost.results[0].comments_count - 1,\r\n          },\r\n        ],\r\n      }));\r\n\r\n      setComments((prevComments) => ({\r\n        ...prevComments,\r\n        results: prevComments.results.filter((comment) => comment.id !== id),\r\n      }));\r\n    } catch (err) {}\r\n  };\r\n\r\n\r\n\r\n  return (\r\n    <>\r\n      <hr />\r\n      <Media className={styles.mainDiv}>\r\n      <div>\r\n      {is_owner && !showEditForm && (\r\n          <MoreDropdown\r\n            handleEdit={() => setShowEditForm(true)}\r\n            handleDelete={handleDelete}\r\n          />\r\n        )}\r\n      </div>\r\n       <div>\r\n       <Link to={`/profiles/${profile_id}`}>\r\n          <Avatar src={profile_image} />\r\n        </Link>\r\n       </div>\r\n        <Media.Body className=\"align-self-center ml-2\">\r\n          <div>\r\n          <span className={styles.Owner}>{owner}</span>\r\n          <span className={styles.Date}>{updated_at}</span>\r\n          </div>\r\n          {showEditForm ? (\r\n            <CommentEditForm\r\n              id={id}\r\n              profile_id={profile_id}\r\n              content={content}\r\n              profileImage={profile_image}\r\n              setComments={setComments}\r\n              setShowEditForm={setShowEditForm}\r\n            />\r\n          ) : (\r\n           <div> <p>{content}</p></div>\r\n          )}\r\n          \r\n        </Media.Body>\r\n        \r\n      </Media>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Comment;"],"mappings":"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"},"metadata":{},"sourceType":"module"}